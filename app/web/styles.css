:root{
  --bg:#0b0c10; --card:#15171c; --ink:#eaecef; --muted:#9aa0a6; --line:#232732; --accent:#5eead4;
}
*{box-sizing:border-box}
html,body{height:100%}
body{margin:0;font:16px/1.45 Inter, system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;background:var(--bg);color:var(--ink)}

/* LOGIN */
.login-screen{display:grid;place-items:center;min-height:100vh;padding:24px}
.login-card{width:100%;max-width:360px;background:var(--card);border:1px solid var(--line);border-radius:16px;padding:20px}
.brand{font-size:28px;margin:0 0 16px;text-align:center;letter-spacing:.5px}
.vstack{display:grid;gap:10px}
.small{font-size:13px}
.muted{color:var(--muted)}
.primary{background:var(--accent);color:#002b29;border:none;padding:10px 14px;border-radius:12px;cursor:pointer;font-weight:600}
input,textarea{background:#0f1218;color:var(--ink);border:1px solid var(--line);border-radius:12px;padding:10px}
textarea{min-height:90px;resize:vertical}

/* APP SHELL */
.app-layout{display:grid;grid-template-rows:auto 1fr auto;min-height:100vh}
.topbar{display:flex;align-items:center;justify-content:space-between;padding:10px 14px;border-bottom:1px solid var(--line);background:rgba(0,0,0,.2);backdrop-filter:blur(4px);position:sticky;top:0;z-index:5}
.brand-small{font-weight:700}
.icon-btn{background:transparent;border:1px solid var(--line);color:var(--ink);border-radius:12px;padding:6px 10px;cursor:pointer}

.screen{padding:10px 10px 70px 10px;max-width:680px;margin:0 auto;width:100%}

/* TABBAR */
.tabbar{position:fixed;bottom:0;left:0;right:0;display:grid;grid-template-columns:repeat(4,1fr);gap:6px;background:#0e1016;border-top:1px solid var(--line);padding:8px 10px}
.tab{background:transparent;border:1px solid var(--line);color:var(--ink);border-radius:12px;padding:10px 0;cursor:pointer}
.tab.active{border-color:var(--accent)}
.tab.big{font-size:22px;font-weight:700}

/* FEED & CARDS */
.feed,.grid-list{display:grid;gap:12px}
.card{background:var(--card);border:1px solid var(--line);border-radius:16px;padding:12px}
.row{display:flex;align-items:center}
.gap{gap:12px}
.inline{display:flex;align-items:center;gap:8px}
.qbox{border:1px dashed var(--line);border-radius:12px;padding:8px}

.item h3{margin:0 0 6px}
.item .sub{color:var(--muted);font-size:14px;display:flex;gap:8px}

/* PROFILE */
.avatar{width:64px;height:64px;image-rendering:pixelated;border-radius:10px;border:1px solid var(--line)}
.avatar-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(90px,1fr));gap:10px}
.avatar-grid button{display:flex;flex-direction:column;gap:6px;align-items:center;justify-content:center;border:1px solid var(--line);border-radius:12px;background:#12151d;padding:8px;color:var(--ink);cursor:pointer}
.avatar-grid img{width:72px;height:72px;image-rendering:pixelated;border-radius:8px;border:1px solid var(--line)}

.profile-header {
  display: flex;
  align-items: center;
  gap: 16px;
  margin-bottom: 1rem;
  flex-wrap: wrap; /* чтобы на маленьких экранах аватар и инфо переносились */
}
.profile-info h2{
  margin:0;
  font-size:1.4rem;
}
.profile-stats{
  display:flex;
  gap:16px;
  font-size:0.95rem;
  color:#ccc;
  margin:.25rem 0 .5rem;
}

.quiz-grid {
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: 8px;
  width: 100%;
}
.quiz-tile {
  background: #1c1f2a;
  border: 1px solid #2c3342;
  border-radius: 10px;
  padding: 10px;
  min-height: 90px;
  cursor: pointer;
  display: flex;
  align-items: end;   /* заголовок внизу, как карточка */
  justify-content: center;
  text-align: center;
  transition: transform .12s ease, background .12s ease, border-color .12s ease;
  position: relative;
}
.quiz-tile:hover {
  transform: scale(1.02);
  background: #23283b;
  border-color: #39425a;
}
.quiz-tile-title{
  font-weight: 600;
  line-height: 1.2;
}

.icon-btn{
  background:#1f2430;border:1px solid #2c3342;border-radius:10px;padding:6px 10px;cursor:pointer
}
.icon-btn:hover{border-color:#5eead4}

.profile-header{
  display:flex;align-items:center;gap:16px
}
.profile-info h2{margin:0;font-size:1.4rem;display:flex;align-items:center;gap:8px}
.profile-stats{display:flex;gap:16px;font-size:.95rem;color:#ccc;margin:.25rem 0 .5rem}

.quiz-grid{display:grid;grid-template-columns:repeat(3,1fr);gap:8px}
.quiz-tile{
  background:#1c1f2a;border:1px solid #2c3342;border-radius:10px;padding:10px;min-height:90px;
  cursor:pointer;display:flex;align-items:center;justify-content:center;text-align:center;
  transition:transform .12s ease, background .12s ease, border-color .12s ease
}
.quiz-tile:hover{transform:scale(1.02);background:#23283b;border-color:#39425a}
.quiz-tile-title{font-weight:600;line-height:1.2}

.avatar-grid{
  display:grid;grid-template-columns:repeat(auto-fill,minmax(96px,1fr));gap:10px
}
.avatar-btn{display:flex;flex-direction:column;align-items:center;padding:8px;border:1px solid #2c3342;border-radius:10px;background:#1f2430;cursor:pointer}
.avatar-btn.selected{outline:2px solid #5eead4}

.profile {
  display: flex;
  flex-direction: column;
  align-items: stretch;
}

/* --- PROFILE LAYOUT FIX --- */
.profile {
  display: flex;
  flex-direction: column;
  align-items: stretch;
}

/* у #meCard убираем "row"-поведение */
#meCard {
  display: block;           /* перебивает .row { display:flex } */
}

/* шапка профиля (аватар + инфо) */
.profile-header {
  display: flex;
  align-items: center;
  gap: 16px;
  margin-bottom: 1rem;      /* отступ вниз, чтобы сетка была ниже */
  flex-wrap: wrap;          /* красиво переносится на узких экранах */
}

/* counters */
.profile-info h2 {
  margin: 0;
  font-size: 1.4rem;
  display: flex;
  align-items: center;
  gap: 8px;
}
.profile-stats {
  display: flex;
  gap: 16px;
  font-size: .95rem;
  color: #ccc;
  margin: .25rem 0 .5rem;
}

/* сетка "Мои квизы" — всегда под шапкой */
.quiz-grid {
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: 8px;
  width: 100%;
}
.quiz-tile {
  background: #1c1f2a;
  border: 1px solid #2c3342;
  border-radius: 10px;
  padding: 10px;
  min-height: 90px;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  text-align: center;
  transition: transform .12s ease, background .12s ease, border-color .12s ease;
}
.quiz-tile:hover {
  transform: scale(1.02);
  background: #23283b;
  border-color: #39425a;
}
.quiz-tile-title {
  font-weight: 600;
  line-height: 1.2;
}

/* страница настроек — чтобы сетка аватаров выглядела ровно */
.avatar-grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(96px, 1fr));
  gap: 10px;
}
.avatar-btn {
  display: flex;
  flex-direction: column;
  align-items: center;
  padding: 8px;
  border: 1px solid #2c3342;
  border-radius: 10px;
  background: #1f2430;
  cursor: pointer;
}
.avatar-btn.selected { outline: 2px solid #5eead4; }

.icon-btn{
  background:#1f2430;border:1px solid #2c3342;border-radius:10px;padding:6px 10px;cursor:pointer
}
.icon-btn:hover{border-color:#5eead4}

.profile-header {
  border-bottom: 1px solid #2c3342;
  padding-bottom: 1rem;
}

.quiz-tile {
  background: #222738;
  aspect-ratio: 1 / 1; /* квадрат */
  overflow: hidden;
  position: relative;
}
.quiz-tile-title {
  position: absolute;
  bottom: 0;
  left: 0;
  right: 0;
  background: rgba(0,0,0,0.55);
  color: #fff;
  font-size: 0.9rem;
  padding: 4px 6px;
  text-overflow: ellipsis;
  overflow: hidden;
  white-space: nowrap;
}

.profile-info {
  display: flex;
  flex-direction: column;
  justify-content: center;
}
.profile-info h2 {
  display: flex;
  align-items: center;
  gap: 10px;
}
.icon-btn {
  font-size: 0.9rem;
  padding: 4px 8px;
}

.quiz-view .muted { margin-top: -6px; }

.quiz-form .q-block {
  border: 1px solid #2c3342;
  border-radius: 10px;
  padding: 10px 12px;
  background: #1f2430;
}

.quiz-form legend {
  padding: 0 6px;
  font-weight: 600;
  margin-bottom: 6px;
}

.option {
  display: flex;
  align-items: center;
  gap: 8px;
  padding: 6px 4px;
  border-radius: 8px;
}
.option:hover {
  background: #23283b;
}
.option input[type="radio"] {
  transform: scale(1.1);
}

.tabbar {
  display: grid;
  grid-template-columns: repeat(5, 1fr); /* <-- 5 равных колонок */
  align-items: center;
  justify-items: center;
  background: #1a1d2a;
  padding: 8px 0;
  border-top: 1px solid #2c3342;
  position: fixed;
  bottom: 0;
  left: 0;
  right: 0;
}

.tab {
  background: none;
  border: none;
  color: #ccc;
  font-size: 1.4rem;
  cursor: pointer;
  transition: color 0.15s, transform 0.15s;
}

.tab:hover {
  color: #fff;
  transform: scale(1.1);
}

.tab.active {
  color: #4da3ff;
}

.tab.big {
  font-size: 1.9rem;
}

.user-list {
  display: grid;
  grid-template-columns: repeat(1, 1fr);
  gap: 6px;
  margin: 8px 0 12px;
}
.user-item {
  display: grid;
  grid-template-columns: 36px 1fr;
  align-items: center;
  gap: 10px;
  padding: 8px;
  border: 1px solid #2c3342;
  border-radius: 10px;
  background: #1f2430;
  cursor: pointer;
  text-align: left;
}
.user-item:hover {
  background: #23283b;
  border-color: #39425a;
}

.follow-btn {
  background: #2a5eea;
  color: #fff;               /* важно: белый текст */
  border: 1px solid #2a5eea;
  border-radius: 10px;
  padding: 6px 10px;
  cursor: pointer;           /* рука, чтобы было видно, что кликабельно */
  font-size: 0.9rem;
  line-height: 1;            /* чтобы текст не «обрезался» */
}
.follow-btn:hover { opacity: .9; }
.follow-btn.danger {
  background: #a33e3e;
  border-color: #a33e3e;
}

/* Ряд варианта ответа: галочка + текст */
.opt-row {
  display: grid;
  grid-template-columns: 22px 1fr;
  align-items: center;
  gap: 8px;
  margin: 6px 0;
  padding: 6px 8px;
  border: 1px solid #2c3342;
  border-radius: 10px;
  background: #1f2430;
}
.opt-row:hover { background: #23283b; }
.opt-row input[type="radio"] { transform: scale(1.1); }

/* overlay: плавное затемнение/подсветка на весь экран */
.fx-overlay {
  position: fixed;
  inset: 0;
  pointer-events: none;
  opacity: 0;
  transition: opacity .2s ease;
  z-index: 9999;
  background: rgba(0,0,0,0); /* базовое */
}
.fx-overlay.show { opacity: 1; }
.fx-overlay.ok  { background: rgba(0, 160, 80, 0.25); backdrop-filter: blur(1px); }
.fx-overlay.bad { background: rgba(200, 40, 40, 0.30); backdrop-filter: blur(1px); }

/* канвас конфетти поверх всего */
.confetti-canvas {
  position: fixed;
  inset: 0;
  z-index: 9998;
  pointer-events: none;
}

/* точки прогресса шага */
.quiz-progress {
  display: flex;
  gap: 8px;
  margin: 6px 0 4px;
  justify-content: center;
}
.quiz-progress .dot {
  width: 10px;
  height: 10px;
  border-radius: 50%;
  background: #3a4156;
  opacity: .6;
}
.quiz-progress .dot.active {
  background: #4da3ff;
  opacity: 1;
}
.quiz-progress .dot.passed {
  background: #34d399; /* зелёный за пройденные */
  opacity: .9;
}

/* подсветка карточки вопроса */
.q-block.correct { border: 1px solid #2aa46e; box-shadow: 0 0 0 2px rgba(42,164,110,.2) inset; }
.q-block.wrong   { border: 1px solid #b84b4b; box-shadow: 0 0 0 2px rgba(184,75,75,.2) inset; }

.actions {
  display: flex;
  justify-content: flex-end;
  align-items: center;
  gap: 12px;
  margin-top: 8px;
}

.like-btn, .open-btn {
  background: none;
  border: none;
  cursor: pointer;
  font-size: 1.4rem;
  display: flex;
  align-items: center;
  gap: 4px;
  color: #fff;
  transition: transform .12s ease;
}

.like-btn:hover, .open-btn:hover {
  transform: scale(1.15);
}

.like-count {
  font-size: 1rem;
  color: #ccc;
}

.like-btn { filter: drop-shadow(0 0 2px rgba(255,0,0,0.35)); }
.open-btn { filter: drop-shadow(0 0 2px rgba(0,180,255,0.35)); }

/* лайк-кнопки и счетчик */
.actions {
  display: flex;
  justify-content: flex-end;
  align-items: center;
  gap: 12px;
  margin-top: 8px;
}
.like-btn, .open-btn {
  background: none;
  border: none;
  cursor: pointer;
  font-size: 1.4rem;
  display: flex;
  align-items: center;
  gap: 6px;
  color: #fff;
}

/* pop анимация для числа */
@keyframes pop {
  0%   { transform: scale(1);   }
  35%  { transform: scale(1.35);}
  100% { transform: scale(1);   }
}
.like-count.pop {
  animation: pop .35s ease;
}

/* heartbeat анимация для сердца */
@keyframes heartbeat {
  0%   { transform: scale(1);   }
  30%  { transform: scale(1.25);}
  100% { transform: scale(1);   }
}
.like-btn.heartbeat {
  animation: heartbeat .35s ease;
}

.like-btn { filter: drop-shadow(0 0 2px rgba(255,0,0,.35)); }
.open-btn { filter: drop-shadow(0 0 2px rgba(0,170,255,.35)); }

/* Экран результата */
.result-wrap {
  display: grid;
  place-items: center;
  min-height: calc(100dvh - 120px); /* с учётом таббара и топбара */
  padding: 16px;
}

.result-card {
  width: min(560px, 92vw);
  background: #1f2430;
  border: 1px solid #2c3342;
  border-radius: 16px;
  padding: 18px 16px 20px;
  box-shadow: 0 10px 30px rgba(0,0,0,.35);
  text-align: center;
}

.result-badge {
  display: inline-block;
  font-weight: 800;
  font-size: 1.6rem;
  background: linear-gradient(135deg, #3fa7ff, #7affe1);
  color: #0e1220;
  padding: 8px 14px;
  border-radius: 999px;
  margin-bottom: 8px;
}

.actions-center {
  justify-content: center;
}

button.ghost {
  background: transparent;
  border: 1px solid #2c3342;
  color: #d7deff;
}
button.ghost:hover {
  background: #23283b;
}
